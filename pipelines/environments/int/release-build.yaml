---
include:
  - project: "moqap/modules"
    ref: "11.2.2"
    file:
      - "/artifactory/download_artifacts_dir.yml" #gibt es noch nicht in den includes muss in pipeline.yaml hinterlegt werden
      - "/artifactory/upload_artifacts_dir.yml"
      - "/artifactory/clean_artifactory.yml"
      - "/lint/dockerfile/lint_dockerfile.yml"
      - "/jmeter/jmeter.yml"
      - "/eks/kaniko/kaniko.yml"
      - "/trivy/trivy.yml"
      - "/gitleaks/gitleaks.yml"
  - "/pipelines/settings.yaml"
  - "/pipelines/stages/codeanalysis.yaml"
  - "/pipelines/stages/build-jar.yaml"
  - "/pipelines/stages/build-image.yaml"
  - "/pipelines/stages/upload-artifacts.yaml"
  - "/pipelines/stages/secrets-scan.yaml"
  - "/pipelines/trivy/trivy.yaml"

variables:
  DEPLOY_ENV: "int"
  STAGE_ENV: "dev"
  LAP_TEST_DISABLE: "false"
  TRIGGER_BUILD_MANUALLY: "false"
  PROJECT_RUNNER_TAG: "eks-integration"
  BASE_SERVICE_URL: "https://${VERSION_ENV}.bbpneo-iat.cnp-test.comp.db.de"
  SERVICE_URL: "https://${VERSION_ENV}.bbpneo-int.svc.cluster.local:443/actuator/info"
  SONARQUBE_PROJECT_KEY: "${CI_PROJECT_NAME}---Masterbranch"

stages:
  - .pre
  - build-jar
  - static-codeanalysis
  - build-image
  - upload
  - security-scan
  - .post
