---
.job_template: &job_template
  tags:
    - $PROJECT_RUNNER_TAG

Build Go:
  stage: build-go
  <<: *job_template
  image: ${PROD_DOCKER_REPO}.bahnhub.tech.rz.db.de/golang:golang-1.23.4
  script:
    - echo $PATH
    - ls -al /usr
    - ls -al /usr/local
    - ls -al /usr/local/go
    - ls -al /usr/local/go/bin
    - go version
    - echo "Update all Go Modlues"
    - go get -u -t all
    - go mod tidy
    - echo "build executable"
    - GOARCH=amd64 GOOS=linux go build ./cmd/postgres_exporter/
    - mkdir -p ./artifacts/
    - cp postgres_exporter ./artifacts/
  artifacts:
    paths:
      - artifacts/*
