---
Build Jar:
  stage: build-jar
  tags:
    - eks-dev
  image: docker-hub-remote.bahnhub.tech.rz.db.de/openjdk:19-jdk-alpine3.16
  dependencies:
    - lint_dockerfile
    - lint_helm
    - SonarQube
    - Whitesource
  needs:
    - job: lint_dockerfile
    - job: lint_helm
    - job: SonarQube
    - job: Whitesource
  script:
    - export GRADLE_OPTS="$GRADLE_OPTS_OWN"
    - echo $GRADLE_OPTS
    - ./gradlew clean build jacocoTestCoverageVerification bootJar
    - mkdir -p ./artifacts/
    - cp build/libs/*.jar ./artifacts/
  only:
    - branches
  artifacts:
    paths:
      - src/target/*
      - artifacts/*
      - .gradle/
  variables:
    GRADLE_OPTS_OWN: $GRADLE_OPTS_OWN
